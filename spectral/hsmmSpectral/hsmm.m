
%script to train and test spectral model

% ID = 34;

% load(strcat('SpectralTainData', num2str(ID),'.mat'));

%flag = 1; - compute true probabilities

[rootTensor  ...
 tailTensor  ...
 obsTensor  ...
 tranTensor ...
 durTensor ] = learnSpectModel2(train(1:numTrain,:), Nobs, Nhid_true, Dmin_true, Dmax_true, A1_true, A_true, D_true, O_true, flg);

numObs = ceil( (log(Nhid_true)+log(Dmax_true)) / log(Nhid_true) );

if flg
    sp_true = testSpectModel2(test, Nobs, numObs, ...
                              rootTensor,  ...
                              tailTensor,  ...
                              obsTensor,  ...
                              tranTensor, ...
                              durTensor);
else
   sp = testSpectModel2(test, Nobs, numObs, ...
                        rootTensor,  ...
                        tailTensor,  ...
                        obsTensor,  ...
                        tranTensor, ...
                        durTensor);    
end